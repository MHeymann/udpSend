\documentclass[a4paper,10pt]{article}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}

\title{CS 354\\Tutorial 2: RBUDP}
\author{M. Heymann\\15988694@sun.ac.za \and J. Lombard\\16994914@sun.ac.za}
\date{16 August 2017}

\begin{document}

\clearpage\maketitle
\thispagestyle{empty} % make sure no page numbers on title page

\pagebreak

\clearpage\tableofcontents
\thispagestyle{empty}

\pagebreak
\setcounter{page}{1} % Set the page counter to 1

\section{Introduction}
The purpose of this project is to understand UDP and TCP for transfering files
over a network.\\\\
Reliable Blast User Datagram Protocol is a data transfer tool and protocol
specifically designed to move very large files over wide area high-speed
networks \cite{udpDef}.\\\\
Transmission Control Protocol/Internet Protocol is the communication language
used for the Internet and it can also be used on private networks
\cite{tcpDef}.\\
The protocols map to a four-layer model \cite{map}:
\begin{enumerate}
	\item Network Interface (Ethernet)
	\item Network (IP)
	\item Transport (TCP, UDP)
	\item Application (HTTP)
\end{enumerate}
The reliability and transfer rates of these protocols are compared.

\section{Unimplemented features}
All the specified features were implemented.

\section{Description of files}
The program consists of 12 java files.

\subsection{ShareFile.java}
ShareFile.java is the driver file for UDP transfers.

\subsection{ShareTCP.java}
ShareTCP.java is the driver file for TCP transfers.

\subsection{filereceiver}
\subsubsection{Receiver.java}
Receiver.java creates the GUI that enables receiving files with UDP.
\subsubsection{ReceiverReconstructor.java}
RecevierReconstructor.java runs on a separate threads. It receives packets
individually and order the packets by sequence numbers.
The packets are then written to a file.

\subsection{filesender}
\subsubsection{Sender.java}
Sender.java creates the GUI that enables sending files with UDP.
\subsubsection{SenderDeconstructor.java}
SenderDeconstructor.java runs on a separate thread. The files are broken up
into datagram packets with unique sequnce numbers. The packets are then sent
using UDP.

\subsection{layouts}
\subsubsection{RelativeLayout.java}
RelativeLayout.java is an external library for the general layout of the GUIs.

\subsection{packet}
\subsubsection{Packet.java}
Packet.java is a datagram packet abstraction.
\begin{itemize}
	\item int sequenceNumber
	\item int size
	\item byte[] data
\end{itemize}

\subsection{parameters}
\subsubsection{Parameters.java}
Parameters.java contains global parameters that need to be consistent
throughout the source files.

\subsection{tcpreceiver}
\subsubsection{Receiver.java}
Receiver.java creates the GUI that enables receiving files with TCP.
\subsubsection{ReceiverReconstructor.java}
RecevierReconstructor.java runs on a separate threads. It receives packets
individually and writes the packets to a file.

\subsection{tcpsender}
\subsubsection{Sender.java}
Sender.java creates the GUI that enables sending files with TCP.
\subsubsection{SenderDeconstructor.java}
SenderDeconstructor.java runs on a separate thread. The files are broken up
into packets which are sent using TCP.

\section{Program description}
sender receiver gui clients
sender sets receiver ip
set number of datagram packets get sent
Acks of datagrams sent over tcp
repeated until all packets sent
receiver acks each batch 
writes to local disk
EOF terminating signal sent which tells receiver to finalise writing of file

\section{Experiments}
\subsection{Throughput of TCP and RBUDP data transfer}
\begin{tabular}{|ccc|r@.l|r@.l|}
	\hline
	\multicolumn{3}{|c|}{File size} & \multicolumn{4}{|c|}{Time (seconds)}\\
	\hline
	\multicolumn{3}{|c|}{(bytes)} & \multicolumn{2}{c|}{TCP} &
	\multicolumn{2}{c|}{UDP}\\
	\hline
	& 264 & 228 & 0 & 01 & 0 & 01\\
	\hline
	& 368 & 618 & 0 & 01 & 0 & 01\\
	\hline
	3 & 029 & 804 & 0 & 01 & 0 & 01\\
	\hline
	89 & 740 & 009 & 0 & 01 & 0 & 91\\
	\hline
	102 & 802 & 047 & 0 & 01 & 0 & 91\\
	\hline
	140 & 062 & 720 & 0 & 01 & 1 & 31\\
	\hline
	199 & 273 & 479 & 0 & 11 & 1 & 91\\
	\hline
\end{tabular}

\subsection{Transfer rate of RBUDP}
\begin{tabular}{|cccc|r@.l|}
	\hline
	\multicolumn{4}{|c|}{File size} & \multicolumn{2}{|c|}{Time}\\
	\hline
	\multicolumn{4}{|c|}{(bytes)} &
	\multicolumn{2}{c|}{(seconds)}\\
	\hline
	& & 264 & 228 & 0 & 01\\
	\hline
	& & 368 & 618 & 0 & 01\\
	\hline
	& 3 & 029 & 804 & 0 & 01\\
	\hline
	& 89 & 740 & 009 & 0 & 91\\
	\hline
	& 102 & 802 & 047 & 0 & 91\\
	\hline
	& 140 & 062 & 720 & 1 & 31\\
	\hline
	& 199 & 273 & 479 & 1 & 91\\
	\hline
	& 870 & 701 & 581 & 10 & 81\\
	\hline
	1 & 235 & 459 & 142 & 17 & 11\\
	\hline
	1 & 900 & 032 & 010 & 35 & 51\\
	\hline
	2 & 060 & 362 & 926 & 47 & 01\\
	\hline
\end{tabular}

\subsection{Different packet sizes in RBUDP}
\begin{tabular}{|cccc|r@.l|r@.l|r@.l|}
	\hline
	\multicolumn{4}{|c|}{File size} & \multicolumn{6}{c|}{Time (seconds)}\\
	\hline
	\multicolumn{4}{|c|}{(bytes)} &
	\multicolumn{6}{c|}{Packet size (bytes)}\\
	\hline
	& & & & \multicolumn{2}{c|}{5} & \multicolumn{2}{c|}{25} &
	\multicolumn{2}{c|}{50}\\
	\hline
	& & 264 & 228 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& & 368 & 618 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& 3 & 029 & 804 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& 89 & 740 & 009 & 0 & 91 & 0 & 81 & 0 & 41\\
	\hline
	& 102 & 802 & 047 & 0 & 91 & 0 & 91 & 0 & 31\\
	\hline
	& 140 & 062 & 720 & 1 & 31 & 0 & 41 & 0 & 31\\
	\hline
	& 199 & 273 & 479 & 1 & 91 & 1 & 41 & 0 & 61\\
	\hline
	& 870 & 701 & 581 & 10 & 81 & 11 & 71 & 8 & 41\\
	\hline
	1 & 235 & 459 & 142 & 17 & 11 & 3 & 71 & 22 & 61\\
	\hline
	1 & 900 & 032 & 010 & 35 & 51 & 31 & 11 & 31 & 91\\
	\hline
	2 & 060 & 362 & 926 & 47 & 01 & 48 & 71 & 40 & 81\\
	\hline
\end{tabular}

\subsection{Varying packet loss rates}
\begin{tabular}{|cccc|r@.l|r@.l|r@.l|r@.l|}
	\hline
	\multicolumn{4}{|c|}{File size} & \multicolumn{8}{c|}{Time (seconds)}\\
	\hline
	\multicolumn{4}{|c|}{(bytes)} &
	\multicolumn{8}{c|}{Every $n^{th}$ packet dropped}\\
	\hline
	& & & & \multicolumn{2}{c|}{0} & \multicolumn{2}{c|}{10} & 
	\multicolumn{2}{c|}{50} &
	\multicolumn{2}{c|}{100}\\
	\hline
	& & 264 & 228 & 0 & 01 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& & 368 & 618 & 0 & 01 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& 3 & 029 & 804 & 0 & 01 & 0 & 01 & 0 & 01 & 0 & 01\\
	\hline
	& 89 & 740 & 009 & 0 & 91 & 1 & 81 & 1 & 51 & 1 & 81\\
	\hline
	& 102 & 802 & 047 & 0 & 91 & 1 & 91 & 1 & 91 & 2 & 41\\
	\hline
	& 140 & 062 & 720 & 1 & 31 & 2 & 11 & 2 & 31 & 2 & 71\\
	\hline
	& 199 & 273 & 479 & 1 & 91 & 3 & 01 & 3 & 51 & 3 & 51\\
	\hline
\end{tabular}

\section{Issues encountered}
An issue encountered while writing this program was having the UDP socket set
as blocking caused gridlocks in the program.\\
Another issue was when files larger than 2.2GB is sent using UDP. The interger
used for percentage tracking wraps around and the values becomes garbage.

\section{Significant data structures}
A new defined datastructure for the program is a Packet with the fields:
\begin{itemize}
	\item int sequenceNumber
	\item int size
	\item byte[] data
\end{itemize}
Another significant data structure used in this program is a priority queue of
packets. The packets are ordered by sequece number.

\section{Design}
For this program it was decided to used fixed burst sizes instead of a moving
send window. Before the next burst is sent an acknowledgement of the previous
burst must be received.\\
Another decision made was to use the built in Java NIO datagram channel since
Java NIO was already being used.

\section{Compilation and Execution}
The program contains make and run files.\\\\
To compile UDP:
\begin{verbatim}
	cd src
	./make.sh
\end{verbatim}
To compile TCP:
\begin{verbatim}
	cd src
	./maketcp.sh
\end{verbatim}
To run UDP sender:
\begin{verbatim}
	./run.sh send
\end{verbatim}
To run UDP receiver:
\begin{verbatim}
	./run.sh receive
\end{verbatim}
To run TCP sender:
\begin{verbatim}
	./runtcp.sh send
\end{verbatim}
To run TCP receiver:
\begin{verbatim}
	./runtcp.sh receive
\end{verbatim}

\section{Conclusion}
From the experiments it is clear that TCP is faster by orders of magnitude.
Although UDP was reliable it seems TCP has more advantages.
Experimenting with packet sizes shows that larger packets may not necessarily
speed up the transfer.
Experimenting with packet drop rates shows that dropping packets slows the
transfer rate noticably in most cases.\\\\
The experiments also revealed that the interger used for percentage tracking
should have been a long int.

\pagebreak
\bibliographystyle{plain}
\bibliography{references.bib}

\end{document}
